!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).selectivity=t()}}(function(){return function t(e,i,n){function s(o,l){if(!i[o]){if(!e[o]){var u="function"==typeof require&&require;if(!l&&u)return u(o,!0);if(r)return r(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var h=i[o]={exports:{}};e[o][0].call(h.exports,function(t){var i=e[o][1][t];return s(i||t)},h,h.exports,t,e,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e,i){var n=t(10).Symbol;e.exports=n},{10:10}],2:[function(t,e,i){e.exports=function(t,e){for(var i=-1,n=null==t?0:t.length,s=Array(n);++i<n;)s[i]=e(t[i],i,t);return s}},{}],3:[function(t,e,i){var n=t(1),s=t(8),r=t(9),o="[object Null]",l="[object Undefined]",u=n?n.toStringTag:void 0;e.exports=function(t){return null==t?void 0===t?l:o:u&&u in Object(t)?s(t):r(t)}},{1:1,8:8,9:9}],4:[function(t,e,i){e.exports=function(t){return function(e){return null==t?void 0:t[e]}}},{}],5:[function(t,e,i){function n(t){if("string"==typeof t)return t;if(o(t))return r(t,n)+"";if(l(t))return h?h.call(t):"";var e=t+"";return"0"==e&&1/t==-u?"-0":e}var s=t(1),r=t(2),o=t(13),l=t(17),u=1/0,a=s?s.prototype:void 0,h=a?a.toString:void 0;e.exports=n},{1:1,13:13,17:17,2:2}],6:[function(t,e,i){var n=t(4)({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});e.exports=n},{4:4}],7:[function(t,e,i){(function(t){var i="object"==typeof t&&t&&t.Object===Object&&t;e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(t,e,i){var n=t(1),s=Object.prototype,r=s.hasOwnProperty,o=s.toString,l=n?n.toStringTag:void 0;e.exports=function(t){var e=r.call(t,l),i=t[l];try{t[l]=void 0;var n=!0}catch(t){}var s=o.call(t);return n&&(e?t[l]=i:delete t[l]),s}},{1:1}],9:[function(t,e,i){var n=Object.prototype.toString;e.exports=function(t){return n.call(t)}},{}],10:[function(t,e,i){var n=t(7),s="object"==typeof self&&self&&self.Object===Object&&self,r=n||s||Function("return this")();e.exports=r},{7:7}],11:[function(t,e,i){var n=t(14),s=t(18),r=t(19),o="Expected a function",l=Math.max,u=Math.min;e.exports=function(t,e,i){function a(e){var i=g,n=m;return g=m=void 0,I=e,w=t.apply(n,i)}function h(t){return I=t,b=setTimeout(f,e),x?a(t):w}function c(t){var i=t-I,n=e-(t-_);return O?u(n,y-i):n}function d(t){var i=t-_,n=t-I;return void 0===_||i>=e||i<0||O&&n>=y}function f(){var t=s();if(d(t))return p(t);b=setTimeout(f,c(t))}function p(t){return b=void 0,E&&g?a(t):(g=m=void 0,w)}function v(){var t=s(),i=d(t);if(g=arguments,m=this,_=t,i){if(void 0===b)return h(_);if(O)return b=setTimeout(f,e),a(_)}return void 0===b&&(b=setTimeout(f,e)),w}var g,m,y,w,b,_,I=0,x=!1,O=!1,E=!0;if("function"!=typeof t)throw new TypeError(o);return e=r(e)||0,n(i)&&(x=!!i.leading,y=(O="maxWait"in i)?l(r(i.maxWait)||0,e):y,E="trailing"in i?!!i.trailing:E),v.cancel=function(){void 0!==b&&clearTimeout(b),I=0,g=_=m=b=void 0},v.flush=function(){return void 0===b?w:p(s())},v}},{14:14,18:18,19:19}],12:[function(t,e,i){var n=t(6),s=t(20),r=/[&<>"']/g,o=RegExp(r.source);e.exports=function(t){return(t=s(t))&&o.test(t)?t.replace(r,n):t}},{20:20,6:6}],13:[function(t,e,i){var n=Array.isArray;e.exports=n},{}],14:[function(t,e,i){e.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},{}],15:[function(t,e,i){e.exports=function(t){return null!=t&&"object"==typeof t}},{}],16:[function(t,e,i){var n=t(3),s=t(13),r=t(15),o="[object String]";e.exports=function(t){return"string"==typeof t||!s(t)&&r(t)&&n(t)==o}},{13:13,15:15,3:3}],17:[function(t,e,i){var n=t(3),s=t(15),r="[object Symbol]";e.exports=function(t){return"symbol"==typeof t||s(t)&&n(t)==r}},{15:15,3:3}],18:[function(t,e,i){var n=t(10);e.exports=function(){return n.Date.now()}},{10:10}],19:[function(t,e,i){var n=t(14),s=t(17),r=NaN,o=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,a=/^0o[0-7]+$/i,h=parseInt;e.exports=function(t){if("number"==typeof t)return t;if(s(t))return r;if(n(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=n(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var i=u.test(t);return i||a.test(t)?h(t.slice(2),i?2:8):l.test(t)?r:+t}},{14:14,17:17}],20:[function(t,e,i){var n=t(5);e.exports=function(t){return null==t?"":n(t)}},{5:5}],21:[function(t,e,i){"use strict";function n(t){s.each(l,function(e,i){t.on(e,function(t){t.originalEvent&&i.forEach(function(e){t[e]=t.originalEvent[e]})})})}var s=window.jQuery||window.Zepto,r=t(16),o=t(37),l={change:["added","removed","value"],"selectivity-change":["added","removed","value"],"selectivity-highlight":["id","item"],"selectivity-selected":["id","item"],"selectivity-selecting":["id","item"]};s.fn.selectivity=function(t,e){var i,l=Array.prototype.slice.call(arguments,1);return this.each(function(){var u=this.selectivity;if(u){if("data"===t?t=l.length?"setData":"getData":"val"===t||"value"===t?t=l.length?"setValue":"getValue":r(t)||(l=[t],t="setOptions"),!s.isFunction(u[t]))throw new Error("Unknown method: "+t);void 0===i&&(i=u[t].apply(u,l))}else if(r(t)){if("destroy"!==t)throw new Error("Cannot call method on element without Selectivity instance")}else{e=s.extend({},t,{element:this});var a=s(this);a.is("select")&&a.prop("multiple")&&(e.multiple=!0);var h=o.Inputs,c=e.inputType||(e.multiple?"Multiple":"Single");if(!s.isFunction(c)){if(!h[c])throw new Error("Unknown Selectivity input type: "+c);c=h[c]}this.selectivity=new c(e),n(a=s(this.selectivity.el)),void 0===i&&(i=a)}}),void 0===i?this:i},o.patchEvents=n,s.Selectivity=o},{16:16,37:37,jquery:"jquery"}],22:[function(t,e,i){"use strict";function n(t,e){for(;t&&!u(t,e);)t=t.parentElement;return t||null}function s(t,e){this.el=a(t.template("dropdown",{dropdownCssClass:t.options.dropdownCssClass,searchInputPlaceholder:t.options.searchInputPlaceholder,showSearchInput:e.showSearchInput})),this.resultsContainer=this.$(".selectivity-results-container"),this.hasMore=!1,this.highlightedResult=null,this.loadMoreHighlighted=!1,this.options=e,this.results=[],this.selectivity=t,this._closed=!1,this._lastMousePosition={},this.close=this.close.bind(this),this.position=this.position.bind(this),!1!==t.options.closeOnSelect&&t.events.on("selectivity-selecting",this.close),this.addToDom(),this.showLoading(),e.showSearchInput&&(t.initInput(this.$(".selectivity-search-input")),t.focus());var i={};i["click "+p]=this._loadMoreClicked,i["click "+v]=this._resultClicked,i["mouseenter "+p]=this._loadMoreHovered,i["mouseenter "+v]=this._resultHovered,this.events=new o(this.el,this),this.events.on(i),this._attachScrollListeners(),this._suppressWheel(),setTimeout(this.triggerOpen.bind(this),1)}var r=(window.jQuery||window.Zepto).extend,o=t(23),l=t(40),u=t(42),a=t(43),h=t(44),c=t(45),d=t(46),f=t(37),p=".selectivity-load-more",v=".selectivity-result-item",g=["scroll","touchend","touchmove"];r(s.prototype,{$:function(t){return this.el.querySelector(t)},addToDom:function(){this.selectivity.el.appendChild(this.el)},close:function(){this._closed||(this._closed=!0,h(this.el),this.selectivity.events.off("selectivity-selecting",this.close),this.triggerClose(),this._removeScrollListeners())},highlight:function(t,e){d(this.$(".highlight"),"highlight",!1),d(this.$(l(v,t.id)),"highlight",!0),this.highlightedResult=t,this.loadMoreHighlighted=!1,this.selectivity.triggerEvent("selectivity-highlight",{item:t,id:t.id,reason:e&&e.reason||"unspecified"})},highlightLoadMore:function(){d(this.$(".highlight"),"highlight",!1),d(this.$(p),"highlight",!0),this.highlightedResult=null,this.loadMoreHighlighted=!0},loadMore:function(){h(this.$(p)),this.resultsContainer.innerHTML+=this.selectivity.template("loading"),this.options.query({callback:function(t){if(!t||!t.results)throw new Error("callback must be passed a response object");this._showResults(f.processItems(t.results),{add:!0,hasMore:!!t.more})}.bind(this),error:this._showResults.bind(this,[],{add:!0}),offset:this.results.length,selectivity:this.selectivity,term:this.term})},position:function(){var t=this.options.position;t&&t(this.el,this.selectivity.el),this._scrolled()},renderItems:function(t){var e=this.selectivity;return t.map(function(t){var i=e.template(t.id?"resultItem":"resultLabel",t);return t.children&&(i+=e.template("resultChildren",{childrenHtml:this.renderItems(t.children)})),i},this).join("")},search:function(t){if(this.term=t,this.options.items){t=f.transformText(t);var e=this.selectivity.options.matcher||f.matcher;this._showResults(this.options.items.map(function(i){return e(i,t)}).filter(function(t){return!!t}),{term:t})}else this.options.query&&this.options.query({callback:function(e){if(!e||!e.results)throw new Error("callback must be passed a response object");this._showResults(f.processItems(e.results),{hasMore:!!e.more,term:t})}.bind(this),error:this.showError.bind(this),offset:0,selectivity:this.selectivity,term:t})},selectHighlight:function(){this.highlightedResult?this.selectItem(this.highlightedResult.id):this.loadMoreHighlighted&&this.loadMore()},selectItem:function(t){var e=f.findNestedById(this.results,t);if(e&&!e.disabled&&!1!==e.selectable){var i={id:t,item:e};this.selectivity.triggerEvent("selectivity-selecting",i)&&this.selectivity.triggerEvent("selectivity-selected",i)}},showError:function(t,e){this.resultsContainer.innerHTML=this.selectivity.template("error",{escape:!e||!1!==e.escape,message:t}),this.hasMore=!1,this.results=[],this.highlightedResult=null,this.loadMoreHighlighted=!1,this.position()},showLoading:function(){this.resultsContainer.innerHTML=this.selectivity.template("loading"),this.hasMore=!1,this.results=[],this.highlightedResult=null,this.loadMoreHighlighted=!1,this.position()},showResults:function(t,e){e.add?h(this.$(".selectivity-loading")):this.resultsContainer.innerHTML="";var i=this.selectivity.filterResults(t),n=this.renderItems(i);e.hasMore?n+=this.selectivity.template("loadMore"):n||e.add||(n=this.selectivity.template("noResults",{term:e.term})),this.resultsContainer.innerHTML+=n,this.results=e.add?this.results.concat(t):t,this.hasMore=e.hasMore;var s=this.selectivity.getValue();if(s&&!Array.isArray(s)){var r=f.findNestedById(t,s);r&&this.highlight(r,{reason:"current_value"})}else!1===this.options.highlightFirstItem||e.add&&!this.loadMoreHighlighted||this._highlightFirstItem(i);this.position()},triggerClose:function(){this.selectivity.triggerEvent("selectivity-close")},triggerOpen:function(){this.selectivity.triggerEvent("selectivity-open")},_attachScrollListeners:function(){for(var t=0;t<g.length;t++)window.addEventListener(g[t],this.position,!0);window.addEventListener("resize",this.position)},_highlightFirstItem:function(t){function e(t){for(var i=0,n=t.length;i<n;i++){var s=t[i];if(s.id)return s;if(s.children){var r=e(s.children);if(r)return r}}}var i=e(t);i?this.highlight(i,{reason:"first_result"}):(this.highlightedResult=null,this.loadMoreHighlighted=!1)},_loadMoreClicked:function(t){this.loadMore(),c(t)},_loadMoreHovered:function(t){void 0!==t.screenX&&t.screenX===this._lastMousePosition.x&&void 0!==t.screenY&&t.screenY===this._lastMousePosition.y||(this.highlightLoadMore(),this._recordMousePosition(t))},_recordMousePosition:function(t){this._lastMousePosition={x:t.screenX,y:t.screenY}},_removeScrollListeners:function(){for(var t=0;t<g.length;t++)window.removeEventListener(g[t],this.position,!0);window.removeEventListener("resize",this.position)},_resultClicked:function(t){this.selectItem(this.selectivity.getRelatedItemId(t)),c(t)},_resultHovered:function(t){if(!t.screenX||t.screenX!==this._lastMousePosition.x||!t.screenY||t.screenY!==this._lastMousePosition.y){var e=this.selectivity.getRelatedItemId(t),i=f.findNestedById(this.results,e);i&&!i.disabled&&this.highlight(i,{reason:"hovered"}),this._recordMousePosition(t)}},_scrolled:function(){var t=this.$(p);t&&t.offsetTop-this.resultsContainer.scrollTop<this.el.clientHeight&&this.loadMore()},_showResults:function(t,e){this.showResults(t,r({dropdown:this},e))},_suppressWheel:function(){var t=this.selectivity.options.suppressWheelSelector;if(null!==t){var e=t||".selectivity-results-container";this.events.on("wheel",e,function(t){function i(){c(t),t.preventDefault()}var s=0===t.deltaMode?t.deltaY:40*t.deltaY,r=n(t.target,e),o=r.clientHeight,l=r.scrollHeight,u=r.scrollTop;l>o&&(s<-u?(r.scrollTop=0,i()):s>l-o-u&&(r.scrollTop=l,i()))})}}}),e.exports=f.Dropdown=s},{23:23,37:37,40:40,42:42,43:43,44:44,45:45,46:46,"lodash/assign":"lodash/assign"}],23:[function(t,e,i){"use strict";function n(t,e){this.context=e||null,this.el=t,this.events={},this._onEvent=this._onEvent.bind(this)}var s=(window.jQuery||window.Zepto).extend,r=t(16),o=t(42),l=["blur","focus","mouseenter","mouseleave","scroll"];s(n.prototype,{destruct:function(){Object.keys(this.events).forEach(function(t){var e=l.indexOf(t)>-1;this.el.removeEventListener(t,this._onEvent,e)},this),this.context=null,this.el=null,this.events=null},off:function(t,e,i){if(r(e)||(i=e,e=""),i){var n=this.events[t];if(n&&(n=n[e]))for(var s=0;s<n.length;s++)n[s]===i&&(n.splice(s,1),s--)}else this.events[t][e]=[]},on:function(t,e,i){if(r(t)){if(r(e)||(i=e,e=""),!this.events.hasOwnProperty(t)){var n=l.indexOf(t)>-1;this.el.addEventListener(t,this._onEvent,n),this.events[t]={}}this.events[t].hasOwnProperty(e)||(this.events[t][e]=[]),this.events[t][e].indexOf(i)<0&&this.events[t][e].push(i)}else{var s=t;for(var o in s)if(s.hasOwnProperty(o)){var u=o.split(" ");u.length>1?this.on(u[0],u[1],s[o]):this.on(u[0],s[o])}}},_onEvent:function(t){function e(e){for(var i=0;i<e.length;i++)e[i].call(s,t)}var i=!1,n=t.stopPropagation;t.stopPropagation=function(){n.call(t),i=!0};for(var s=this.context,r=t.target,l=this.events[t.type.toLowerCase()];r&&r!==this.el&&!i;){for(var u in l)u&&l.hasOwnProperty(u)&&o(r,u)&&e(l[u]);r=r.parentElement}!i&&l.hasOwnProperty("")&&e(l[""])}}),e.exports=n},{16:16,42:42,"lodash/assign":"lodash/assign"}],24:[function(t,e,i){"use strict";function n(t){var e=t.indexOf("@");if(-1===e||t.indexOf(" ")>-1)return!1;var i=t.lastIndexOf(".");return-1===i?e<t.length-2:!(i>e)||i<t.length-2}function s(t,e){for(var i=(e=void 0===e?t.length:e)-1;i>=0;i--)if(/\s/.test(t[i]))return t.slice(i+1,e);return t.slice(0,e)}function r(t,e){return t.charAt(0)===e[0]&&t.slice(-1)===e[1]?t.slice(1,-1).trim():t.trim()}function o(t){var e=s(t),i=t.slice(0,-e.length).trim();return n(e)?(e=r(r(e,"()"),"<>"),i=r(i,'""').trim()||e,{id:e,text:i}):t.trim()?{id:t,text:t}:null}function l(t,e,i){for(;function(t){if(t)for(var e=0,i=t.length;e<i;e++)switch(t[e]){case";":case",":case"\n":return!0;case" ":case"\t":if(n(s(t,e)))return!0;break;case'"':do{e++}while(e<i&&'"'!==t[e]);break;default:continue}return!1}(t);){var r=function(t){for(var e=0,i=t.length;e<i;e++)switch(t[e]){case";":case",":case"\n":return{term:t.slice(0,e),input:t.slice(e+1)};case" ":case"\t":if(n(s(t,e)))return{term:t.slice(0,e),input:t.slice(e+1)};break;case'"':do{e++}while(e<i&&'"'!==t[e]);break;default:continue}return{}}(t);if(r.term){var l=o(r.term);!l||l.id&&c.findById(e,l.id)||i(l)}t=r.input}return t}function u(t){h.call(this,a({createTokenItem:o,showDropdown:!1,tokenizer:l},t)),this.events.on("blur",function(){var t=this.input;t&&n(s(t.value))&&this.add(o(t.value))})}var a=(window.jQuery||window.Zepto).extend,h=t(25),c=t(37);c.inherits(u,h),e.exports=c.Inputs.Email=u},{25:25,37:37,"lodash/assign":"lodash/assign"}],25:[function(t,e,i){"use strict";function n(t){o.call(this,s({positionDropdown:function(t,e){var i=e.getBoundingClientRect(),n=t.clientHeight,r=i.bottom+n>window.innerHeight&&i.top-n>0;s(t.style,{left:i.left+"px",top:(r?i.top-n:i.bottom)+"px",width:i.width+"px"})},showSearchInputInDropdown:!1},t)),this._reset();var e={change:this.rerenderSelection,click:this._clicked,"selectivity-selected":this._resultSelected};e["change "+f]=c,e["click "+p]=this._itemClicked,e["click "+p+"-remove"]=this._itemRemoveClicked,e["keydown "+f]=this._keyHeld,e["keyup "+f]=this._keyReleased,e["paste "+f]=this._onPaste,this.events.on(e)}var s=(window.jQuery||window.Zepto).extend,r=t(16),o=t(37),l=t(40),u=t(41),a=t(43),h=t(44),c=t(45),d=t(46),f=".selectivity-multiple-input",p=".selectivity-multiple-selected-item",v="ontouchstart"in window,g=o.inherits(n,o,{add:function(t){var e=o.isValidId(t),i=e?t:this.validateItem(t)&&t.id;-1===this._value.indexOf(i)&&(this._value.push(i),e&&this.options.initSelection?this.options.initSelection([i],function(e){this._value.indexOf(i)>-1&&(t=this.validateItem(e[0]),this._data.push(t),this.triggerChange({added:t}))}.bind(this)):(e&&(t=this.getItemForId(i)),this._data.push(t),this.triggerChange({added:t}))),this.input.value="",this._updateInputWidth()},clear:function(){this.setData([])},filterResults:function(t){return(t=t.map(function(t){var e={id:t.id,text:t.text};return t.children&&(e.children=this.filterResults(t.children)),e},this)).filter(function(t){return!o.findById(this._data,t.id)},this)},getDataForValue:function(t){return t.map(this.getItemForId,this).filter(function(t){return!!t})},getValueForData:function(t){return t.map(function(t){return t.id})},remove:function(t){var e,i=t.id||t,n=o.findIndexById(this._data,i);n>-1&&(e=this._data[n],this._data.splice(n,1)),this._value[n]!==i&&(n=this._value.indexOf(i)),n>-1&&this._value.splice(n,1),e&&this.triggerChange({removed:e}),i===this._highlightedItemId&&(this._highlightedItemId=null),this._updateInputWidth()},rerenderSelection:function(t){(t=t||{}).added?(this._renderSelectedItem(t.added),this._scrollToBottom()):t.removed?h(this.$(l(p,t.removed.id))):(this._forEachSelectedItem(h),this._data.forEach(this._renderSelectedItem,this),this._updateInputWidth()),(t.added||t.removed)&&(this.dropdown&&this.dropdown.showResults(this.filterResults(this.dropdown.results),{hasMore:this.dropdown.hasMore}),v||this.focus()),this.positionDropdown(),this._updatePlaceholder()},search:function(t){this.options.tokenizer&&(t=this.options.tokenizer(t,this._data,this.add.bind(this),this.options),r(t)&&t!==this.input.value&&(this.input.value=t)),this._updateInputWidth(),this.dropdown&&g(this,"search",t)},setOptions:function(t){var e=this.enabled;g(this,"setOptions",t),e!==this.enabled&&this._reset()},validateData:function(t){if(null===t)return[];if(Array.isArray(t))return t.map(this.validateItem,this);throw new Error("Data for MultiSelectivity instance should be an array")},validateValue:function(t){if(null===t)return[];if(Array.isArray(t)){if(t.every(o.isValidId))return t;throw new Error("Value contains invalid IDs")}throw new Error("Value for MultiSelectivity instance should be an array")},_backspacePressed:function(){this.options.backspaceHighlightsBeforeDelete?this._highlightedItemId?this._deletePressed():this._value.length&&this._highlightItem(this._value.slice(-1)[0]):this._value.length&&this.remove(this._value.slice(-1)[0])},_clicked:function(t){this.enabled&&(!1!==this.options.showDropdown?this.open():this.focus(),c(t))},_createToken:function(){var t=this.input.value,e=this.options.createTokenItem;if(t&&e){var i=e(t);i&&this.add(i)}},_deletePressed:function(){this._highlightedItemId&&this.remove(this._highlightedItemId)},_forEachSelectedItem:function(t){Array.prototype.forEach.call(this.el.querySelectorAll(p),t)},_highlightItem:function(t){this._highlightedItemId=t,this._forEachSelectedItem(function(e){d(e,"highlighted",e.getAttribute("data-item-id")===t)}),v||this.focus()},_itemClicked:function(t){this.enabled&&this._highlightItem(this.getRelatedItemId(t))},_itemRemoveClicked:function(t){this.remove(this.getRelatedItemId(t)),c(t)},_keyHeld:function(t){this._originalValue=this.input.value,13!==u(t)||t.ctrlKey||t.preventDefault()},_keyReleased:function(t){var e=!!this._originalValue,i=u(t);13!==i||t.ctrlKey?8!==i||e?46!==i||e||this._deletePressed():this._backspacePressed():this._createToken()},_onPaste:function(){setTimeout(function(){this.search(this.input.value),this._createToken()}.bind(this),10)},_renderSelectedItem:function(t){var e=a(this.template("multipleSelectedItem",s({highlighted:t.id===this._highlightedItemId,removable:!this.options.readOnly},t)));this.input.parentNode.insertBefore(e,this.input)},_reset:function(){this.el.innerHTML=this.template("multipleSelectInput",{enabled:this.enabled}),this._highlightedItemId=null,this.initInput(this.$(f)),this.rerenderSelection()},_resultSelected:function(t){-1===this._value.indexOf(t.id)?this.add(t.item):this.remove(t.item)},_scrollToBottom:function(){var t=this.$(f+"-container");t.scrollTop=t.clientHeight},_updateInputWidth:function(){if(this.enabled){var t=this.input.value||!this._data.length&&this.options.placeholder||"";this.input.setAttribute("size",t.length+2),this.positionDropdown()}},_updatePlaceholder:function(){var t=!this._data.length&&this.options.placeholder||"";this.enabled?this.input.setAttribute("placeholder",t):this.$(".selectivity-placeholder").textContent=t}});e.exports=o.Inputs.Multiple=n},{16:16,37:37,40:40,41:41,43:43,44:44,45:45,46:46,"lodash/assign":"lodash/assign"}],26:[function(t,e,i){"use strict";function n(t){r.call(this,s({positionDropdown:function(t,e){var i=e.getBoundingClientRect(),n=i.bottom,r=Math.min(Math.max(n+t.clientHeight-window.innerHeight,0),i.top+i.height);s(t.style,{left:i.left+"px",top:n-r+"px",width:i.width+"px"})}},t)),this.rerender(),!1===t.showSearchInputInDropdown&&this.initInput(this.$(".selectivity-single-select-input"),{search:!1}),this.events.on({change:this.rerenderSelection,click:this._clicked,"click .selectivity-search-input":o,"click .selectivity-single-selected-item-remove":this._itemRemoveClicked,"focus .selectivity-single-select-input":this._focused,"selectivity-selected":this._resultSelected})}var s=(window.jQuery||window.Zepto).extend,r=t(37),o=t(45),l=r.inherits(n,r,{clear:function(){this.setData(null)},close:function(t){this._closing=!0,l(this,"close"),t&&t.keepFocus&&this.input&&this.input.focus(),this._closing=!1},getDataForValue:function(t){return this.getItemForId(t)},getValueForData:function(t){return t?t.id:null},rerender:function(){this.el.innerHTML=this.template("singleSelectInput",this.options),this.rerenderSelection()},rerenderSelection:function(){var t=this._data?"singleSelectedItem":"singleSelectPlaceholder",e=this._data?s({removable:this.options.allowClear&&!this.options.readOnly},this._data):{placeholder:this.options.placeholder};this.el.querySelector("input").value=this._value,this.$(".selectivity-single-result-container").innerHTML=this.template(t,e)},setOptions:function(t){var e=this.enabled;l(this,"setOptions",t),e!==this.enabled&&this.rerender()},validateData:function(t){return null===t?t:this.validateItem(t)},validateValue:function(t){if(null===t||r.isValidId(t))return t;throw new Error("Value for SingleSelectivity instance should be a valid ID or null")},_clicked:function(){this.enabled&&(this.dropdown?this.close({keepFocus:!0}):!1!==this.options.showDropdown&&this.open())},_focused:function(){!this.enabled||this._closing||this._opening||!1===this.options.showDropdown||this.open()},_itemRemoveClicked:function(t){this.setData(null),o(t)},_resultSelected:function(t){this.setData(t.item),this.close({keepFocus:!0})}});e.exports=r.Inputs.Single=n},{37:37,45:45,"lodash/assign":"lodash/assign"}],27:[function(t,e,i){"use strict";var n=t(12),s=t(37);e.exports=s.Locale={loading:"Loading...",loadMore:"Load more...",noResults:"No results found",ajaxError:function(t){return t?"Failed to fetch results for <b>"+n(t)+"</b>":"Failed to fetch results"},needMoreCharacters:function(t){return"Enter "+t+" more characters to search"},noResultsForTerm:function(t){return"No results for <b>"+n(t)+"</b>"}}},{12:12,37:37}],28:[function(t,e,i){"use strict";function n(t,e,i){return t+(t.indexOf("?")>-1?"&":"?")+e+"="+encodeURIComponent(i)}function s(t,e){var i={};return e.forEach(function(e){void 0!==t[e]&&(i[e]=t[e])}),i}function r(t,e){var i=t.fetch||window.fetch,r=e.term,o="function"==typeof t.url?t.url(e):t.url;if(t.params){var l=t.params(r,e.offset||0);for(var a in l)l.hasOwnProperty(a)&&(o=n(o,a,l[a]))}i(o,s(t,["body","cache","credentials","headers","integrity","method","mode","redirect","referrer","referrerPolicy"]),e).then(function(t){if(t.ok)return t.json();if(Array.isArray(t)||t.results)return t;throw new Error("Unexpected AJAX response")}).then(function(t){Array.isArray(t)?e.callback({results:t,more:!1}):e.callback({results:t.results,more:!!t.more})}).catch(function(i){var n=t.formatError||u.ajaxError;e.error(n(r,i),{escape:!1})})}var o=t(11),l=t(37),u=t(27);l.OptionListeners.unshift(function(t,e){var i=e.ajax;if(i&&i.url){var n=i.quietMillis?o(r,i.quietMillis):r;e.query=function(t){var e=i.minimumInputLength-t.term.length;e>0?t.error(u.needMoreCharacters(e)):n(i,t)}}})},{11:11,27:27,37:37}],29:[function(t,e,i){"use strict";var n=0;t(37).OptionListeners.push(function(t,e){var i=e.query;i&&!i._async&&(e.query=function(t){var e=++n,s=t.callback,r=t.error;t.callback=function(){e===n&&s.apply(null,arguments)},t.error=function(){e===n&&r.apply(null,arguments)},i(t)},e.query._async=!0)})},{37:37}],30:[function(t,e,i){"use strict";var n={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"},s=t(37),r=s.transformText;s.transformText=function(t){for(var e="",i=0,s=t.length;i<s;i++){var o=t[i];e+=n[o]||o}return r(e)}},{37:37}],31:[function(t,e,i){"use strict";var n=window.jQuery||window.Zepto;t(37).OptionListeners.unshift(function(t,e){var i=e.ajax;i&&i.url&&!i.fetch&&n.Deferred&&(i.fetch=function(t,e){return n.ajax(t,{cache:"no-cache"!==e.cache,headers:e.headers||null,method:e.method||"GET",xhrFields:"include"===e.credentials?{withCredentials:!0}:null}).then(function(t){return{results:n.map(t,function(t){return t}),more:!1}},function(t,e,i){throw new Error("AJAX request returned: "+e+(i?", "+i:""))})})})},{37:37,jquery:"jquery"}],32:[function(t,e,i){"use strict";function n(t,e){var i=e.multiple?[]:null,n=function(){var t=r(this);if(t.is("option")){var s=t.text(),o=t.attr("value");if(void 0===o&&(o=s),t.prop("selected")){var l={id:o,text:s};e.multiple?i.push(l):i=l}return{id:o,text:t.attr("label")||s}}return{text:t.attr("label"),children:t.children("option,optgroup").map(n).get()}};e.allowClear="allowClear"in e?e.allowClear:!t.prop("required");var s=t.children("option,optgroup").map(n).get();e.data=i,e.items=e.query?null:s,e.placeholder=e.placeholder||t.data("placeholder")||"",e.tabIndex=void 0===e.tabIndex?t.attr("tabindex")||0:e.tabIndex;var o=(t.attr("class")||"selectivity-input").split(" ");o.indexOf("selectivity-input")<0&&o.push("selectivity-input");var l=r("<div>").attr({id:"s9y_"+t.attr("id"),class:o.join(" "),style:t.attr("style"),"data-name":t.attr("name")});return l.insertAfter(t),t.hide(),l[0]}function s(t){var e=r(t.el);e.on("change",function(t){var i=t.originalEvent.value;e.prev("select").val("array"===r.type(i)?i.slice(0):i).trigger(t)})}var r=window.jQuery||window.Zepto,o=t(37);o.OptionListeners.push(function(t,e){var i=r(t.el);i.is("select")&&(i.attr("autofocus")&&setTimeout(function(){t.focus()},1),t.el=n(i,e),t.el.selectivity=t,o.patchEvents(i),s(t))})},{37:37,jquery:"jquery"}],33:[function(t,e,i){"use strict";var n=t(37),s=t(39),r=t(41),o=8,l=40,u=13,a=27,h=9,c=38;n.InputListeners.push(function(t,e){function i(e,r){function o(){var t;e.highlightedResult?t=s(u,e.highlightedResult.id):e.loadMoreHighlighted&&(t=e.$(".selectivity-load-more")),t&&t.scrollIntoView&&t.scrollIntoView(r<0)}var l=e.results;if(l.length){var u=[].slice.call(e.el.querySelectorAll(".selectivity-result-item"));if(e.submenu)i(e.submenu,r);else{var a=r>0?0:u.length-1,h=a,c=e.highlightedResult;if(c){var d=s(u,c.id);if(h=u.indexOf(d)+r,r>0?h>=u.length:h<0){if(e.hasMore)return e.highlightLoadMore(),void o();h=a}}var f=u[h],p=n.findNestedById(l,t.getRelatedItemId(f));p&&(e.highlight(p,{delay:!!p.submenu}),o())}}}var d=!1,f=null;e.addEventListener("keydown",function(n){var s=t.dropdown;if(s){var a=r(n);if(a===o){if(!e.value){if(s.submenu){for(var p=s.submenu;p.submenu;)p=p.submenu;f=p}n.preventDefault(),d=!0}}else a===l?i(s,1):a===c?i(s,-1):a===h?setTimeout(function(){t.close()},1):a===u&&n.preventDefault()}}),e.addEventListener("keyup",function(e){function i(){!1!==t.options.showDropdown&&t.open()}var n=t.dropdown,s=r(e);d?(e.preventDefault(),d=!1,f&&(f.close(),t.focus(),f=null)):s===o?!n&&t.options.allowClear&&t.clear():s!==u||e.ctrlKey?s===a?(t.close(),e.preventDefault()):s===l||s===c?(i(),e.preventDefault()):i():(n?n.selectHighlight():!1!==t.options.showDropdown&&i(),e.preventDefault())})})},{37:37,39:39,41:41}],34:[function(t,e,i){"use strict";function n(t,e){this.parentMenu=e.parentMenu,s.call(this,t,e),this._closeSubmenuTimeout=0,this._openSubmenuTimeout=0}var s=t(22),r=t(37),o=t(39),l=r.inherits(n,s,{close:function(){this.submenu&&this.submenu.close(),l(this,"close"),this.parentMenu&&(this.parentMenu.submenu=null,this.parentMenu=null),clearTimeout(this._closeSubmenuTimeout),clearTimeout(this._openSubmenuTimeout)},highlight:function(t,e){var i=(e=e||{}).reason||"unspecified";e.delay?(l(this,"highlight",t),clearTimeout(this._openSubmenuTimeout),this._openSubmenuTimeout=setTimeout(this._doHighlight.bind(this,t,i),300)):this.submenu?this.highlightedResult&&this.highlightedResult.id===t.id?this._doHighlight(t,i):(clearTimeout(this._closeSubmenuTimeout),this._closeSubmenuTimeout=setTimeout(this._closeSubmenuAndHighlight.bind(this,t,i),100)):(this.parentMenu&&this.parentMenu._closeSubmenuTimeout&&(clearTimeout(this.parentMenu._closeSubmenuTimeout),this.parentMenu._closeSubmenuTimeout=0),!1===e.openSubmenu?l(this,"highlight",t):this._doHighlight(t,i))},search:function(t){if(this.submenu){var e=this.$(".selectivity-search-input");if(!e||e!==document.activeElement)return void this.submenu.search(t);this.submenu.close()}l(this,"search",t)},selectHighlight:function(){this.submenu?this.submenu.selectHighlight():l(this,"selectHighlight")},showResults:function(t,e){function i(t){t.children&&t.children.forEach(i),t.submenu&&(t.selectable=!!t.selectable)}this.submenu&&e.dropdown!==this?this.submenu.showResults(t,e):(t.forEach(i),l(this,"showResults",t,e))},triggerClose:function(){this.parentMenu?this.selectivity.triggerEvent("selectivity-close-submenu"):l(this,"triggerClose")},triggerOpen:function(){this.parentMenu?this.selectivity.triggerEvent("selectivity-open-submenu"):l(this,"triggerOpen")},_closeSubmenuAndHighlight:function(t,e){this.submenu&&this.submenu.close(),this._doHighlight(t,e)},_doHighlight:function(t,e){l(this,"highlight",t);var i=this.selectivity.options;if(!(!t.submenu||this.submenu||i.shouldOpenSubmenu&&!1===i.shouldOpenSubmenu(t,e))){var n=i.dropdown||r.Dropdown;if(n){var s=this.el.querySelectorAll(".selectivity-result-item"),u=o(s,t.id),a=this.el;this.submenu=new n(this.selectivity,{highlightFirstItem:!t.selectable,items:t.submenu.items||null,parentMenu:this,position:function(e,i){if(t.submenu.positionDropdown)t.submenu.positionDropdown(e,i,u,a);else{var n=a.getBoundingClientRect(),s=n.right,r=n.width;s+r>document.body.clientWidth&&n.left-r>0&&(s=n.left-r+10);var o=u.getBoundingClientRect().top,l=Math.min(Math.max(o+e.clientHeight-window.innerHeight,0),n.top+n.height);e.style.left=s+"px",e.style.top=o-l+"px",e.style.width=r+"px"}},query:t.submenu.query||null,showSearchInput:t.submenu.showSearchInput}),this.submenu.search("")}}}});r.Dropdown=n,e.exports=n},{22:22,37:37,39:39}],35:[function(t,e,i){"use strict";function n(t,e,i,n){for(var s=n.createTokenItem||function(t){return t?{id:t,text:t}:null},o=n.tokenSeparators;function(t){return!!t&&o.some(function(e){return t.indexOf(e)>-1})}(t);){var l=function(t){for(var e=0,i=t.length;e<i;e++)if(o.indexOf(t[e])>-1)return{term:t.slice(0,e),input:t.slice(e+1)};return{}}(t);if(l.term){var u=s(l.term);u&&!r.findById(e,u.id)&&i(u)}t=l.input}return t}var s=(window.jQuery||window.Zepto).extend,r=t(37);r.OptionListeners.push(function(t,e){e.tokenSeparators&&(e.allowedTypes=s({tokenSeparators:"array"},e.allowedTypes),e.tokenizer=e.tokenizer||n)})},{37:37,"lodash/assign":"lodash/assign"}],36:[function(t,e,i){t(22),t(24),t(25),t(26),t(27),t(28),t(29),t(30),t(31),t(32),t(33),t(34),t(35),t(38),t(21)},{21:21,22:22,24:24,25:25,26:26,27:27,28:28,29:29,30:30,31:31,32:32,33:33,34:34,35:35,38:38}],37:[function(t,e,i){"use strict";function n(t){this.dropdown=null,this.el=t.element,this.enabled=!t.readOnly&&!t.removeOnly,this.input=null,this.items=null,this.options={},this.templates=s({},n.Templates),this.term="",this.setOptions(t),t.value?this.setValue(t.value,{triggerChange:!1}):this.setData(t.data||null,{triggerChange:!1}),this.el.setAttribute("tabindex",t.tabIndex||0),this.events=new o(this.el,this),this.events.on({blur:this._blur,mouseenter:this._mouseenter,mouseleave:this._mouseleave,"selectivity-close":this._closed})}var s=(window.jQuery||window.Zepto).extend,r=t(16),o=t(23),l=t(46);s(n.prototype,{$:function(t){return this.el.querySelector(t)},close:function(){this._clearCloseTimeout(),this.dropdown&&(this.dropdown.close(),this.dropdown=null)},destroy:function(){this.events.destruct();for(var t=this.el;t.firstChild;)t.removeChild(t.firstChild);t.selectivity=null},filterResults:function(t){return t},focus:function(){this._clearCloseTimeout(),this._focusing=!0,this.input&&this.input.focus(),this._focusing=!1},getData:function(){return this._data},getItemForId:function(t){var e=this.items;return e?n.findNestedById(e,t):null===t?null:{id:t,text:""+t}},getRelatedItemId:function(t){for(var e=t.target||t;e&&!e.hasAttribute("data-item-id");)e=e.parentNode;if(!e)return null;var i=e.getAttribute("data-item-id");if(n.findById(this._data||[],i))return i;for(var s=this.dropdown;s;){if(n.findNestedById(s.results,i))return i;s=s.submenu}var r=parseInt(i,10);return""+r===i?r:i},getValue:function(){return this._value},initInput:function(t,e){this.input=t;var i=this;(this.options.inputListeners||n.InputListeners).forEach(function(n){n(i,t,e)}),e&&!1===e.search||t.addEventListener("keyup",function(t){t.defaultPrevented||i.search(t.target.value)})},open:function(){if(!this._opening&&!this.dropdown&&this.triggerEvent("selectivity-opening")){this._opening=!0;var t=this.options.dropdown||n.Dropdown;t&&(this.dropdown=new t(this,{items:this.items,position:this.options.positionDropdown,query:this.options.query,showSearchInput:!1!==this.options.showSearchInputInDropdown})),this.search(""),this.focus(),l(this.el,"open",!0),this._opening=!1}},positionDropdown:function(){this.dropdown&&this.dropdown.position()},search:function(t){this.open(),this.dropdown&&this.dropdown.search(t)},setData:function(t,e){e=e||{},t=this.validateData(t),this._data=t,this._value=this.getValueForData(t),!1!==e.triggerChange&&this.triggerChange()},setOptions:function(t){t=t||{};var e=this;n.OptionListeners.forEach(function(i){i(e,t)}),"items"in t&&(this.items=t.items?n.processItems(t.items):null),"templates"in t&&s(this.templates,t.templates),s(this.options,t),this.enabled=!this.options.readOnly&&!this.options.removeOnly},setValue:function(t,e){e=e||{},t=this.validateValue(t),this._value=t,this.options.initSelection?this.options.initSelection(t,function(i){this._value===t&&(this._data=this.validateData(i),!1!==e.triggerChange&&this.triggerChange())}.bind(this)):(this._data=this.getDataForValue(t),!1!==e.triggerChange&&this.triggerChange())},template:function(t,e){var i=this.templates[t];if(!i)throw new Error("Unknown template: "+t);if("function"==typeof i){var n=i(e);return"string"==typeof n?n.trim():n}return i.render?i.render(e).trim():i.toString().trim()},triggerChange:function(t){var e=s({data:this._data,value:this._value},t);this.triggerEvent("change",e),this.triggerEvent("selectivity-change",e)},triggerEvent:function(t,e){var i=document.createEvent("Event");return i.initEvent(t,!1,!0),s(i,e),this.el.dispatchEvent(i),!i.defaultPrevented},validateItem:function(t){if(t&&n.isValidId(t.id)&&r(t.text))return t;throw new Error("Item should have id (number or string) and text (string) properties")},_blur:function(){this._focusing||this.el.classList.contains("hover")||(this._clearCloseTimeout(),this._closeTimeout=setTimeout(this.close.bind(this),166))},_clearCloseTimeout:function(){this._closeTimeout&&(clearTimeout(this._closeTimeout),this._closeTimeout=0)},_closed:function(){this.dropdown=null,l(this.el,"open",!1)},_mouseleave:function(t){this.el.contains(t.relatedTarget)||l(this.el,"hover",!1)},_mouseenter:function(){l(this.el,"hover",!0)}}),n.Dropdown=null,n.InputListeners=[],n.Inputs={},n.OptionListeners=[],n.Templates={},n.findById=function(t,e){var i=n.findIndexById(t,e);return i>-1?t[i]:null},n.findIndexById=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i].id===e)return i;return-1},n.findNestedById=function(t,e){for(var i=0,s=t.length;i<s;i++){var r,o=t[i];if(o.id===e?r=o:o.children?r=n.findNestedById(o.children,e):o.submenu&&o.submenu.items&&(r=n.findNestedById(o.submenu.items,e)),r)return r}return null},n.inherits=function(t,e,i){return t.prototype=s(Object.create(e.prototype),{constructor:t},i),function(t,i){e.prototype[i].apply(t,Array.prototype.slice.call(arguments,2))}},n.isValidId=function(t){return"number"==typeof t||r(t)},n.matcher=function(t,e){var i=null;if(n.transformText(t.text).indexOf(e)>-1)i=t;else if(t.children){var s=t.children.map(function(t){return n.matcher(t,e)}).filter(function(t){return!!t});s.length&&(i={id:t.id,text:t.text,children:s})}return i},n.processItem=function(t){if(n.isValidId(t))return{id:t,text:""+t};if(t&&(n.isValidId(t.id)||t.children)&&r(t.text))return t.children&&(t.children=n.processItems(t.children)),t;throw new Error("invalid item")},n.processItems=function(t){if(Array.isArray(t))return t.map(n.processItem);throw new Error("invalid items")},n.transformText=function(t){return t.toLowerCase()},e.exports=n},{16:16,23:23,46:46,"lodash/assign":"lodash/assign"}],38:[function(t,e,i){"use strict";var n=t(12),s=t(37),r=t(27);s.Templates={dropdown:function(t){var e=t.dropdownCssClass?" "+t.dropdownCssClass:"",i="";if(t.showSearchInput){e+=" has-search-input";var s=t.searchInputPlaceholder;i='<div class="selectivity-search-input-container"><input type="text" class="selectivity-search-input"'+(s?' placeholder="'+n(s)+'"':"")+"></div>"}return'<div class="selectivity-dropdown'+e+'">'+i+'<div class="selectivity-results-container"></div></div>'},error:function(t){return'<div class="selectivity-error">'+(t.escape?n(t.message):t.message)+"</div>"},loading:function(){return'<div class="selectivity-loading">'+r.loading+"</div>"},loadMore:function(){return'<div class="selectivity-load-more">'+r.loadMore+"</div>"},multipleSelectInput:function(t){return'<div class="selectivity-multiple-input-container">'+(t.enabled?'<input type="text" autocomplete="off" autocorrect="off" autocapitalize="off" class="selectivity-multiple-input">':'<div class="selectivity-multiple-input selectivity-placeholder"></div>')+'<div class="selectivity-clearfix"></div></div>'},multipleSelectedItem:function(t){return'<span class="selectivity-multiple-selected-item'+(t.highlighted?" highlighted":"")+'" data-item-id="'+n(t.id)+'">'+(t.removable?'<a class="selectivity-multiple-selected-item-remove"><i class="fa fa-remove"></i></a>':"")+n(t.text)+"</span>"},noResults:function(t){return'<div class="selectivity-error">'+(t.term?r.noResultsForTerm(t.term):r.noResults)+"</div>"},resultChildren:function(t){return'<div class="selectivity-result-children">'+t.childrenHtml+"</div>"},resultItem:function(t){return'<div class="selectivity-result-item'+(t.disabled?" disabled":"")+'" data-item-id="'+n(t.id)+'">'+n(t.text)+(t.submenu?'<i class="selectivity-submenu-icon fa fa-chevron-right"></i>':"")+"</div>"},resultLabel:function(t){return'<div class="selectivity-result-label">'+n(t.text)+"</div>"},singleSelectInput:function(t){return'<div class="selectivity-single-select"><input type="text" class="selectivity-single-select-input"'+(t.required?" required":"")+'><div class="selectivity-single-result-container"></div><i class="fa fa-sort-desc selectivity-caret"></i></div>'},singleSelectPlaceholder:function(t){return'<div class="selectivity-placeholder">'+n(t.placeholder)+"</div>"},singleSelectedItem:function(t){return'<span class="selectivity-single-selected-item" data-item-id="'+n(t.id)+'">'+(t.removable?'<a class="selectivity-single-selected-item-remove"><i class="fa fa-remove"></i></a>':"")+n(t.text)+"</span>"},selectCompliance:function(t){var e=t.mode,i=t.name;return"multiple"===e&&"[]"!==i.slice(-2)&&(i+="[]"),'<select name="'+i+'"'+("multiple"===e?" multiple":"")+"></select>"},selectOptionCompliance:function(t){return'<option value="'+n(t.id)+'" selected>'+n(t.text)+"</option>"}}},{12:12,27:27,37:37}],39:[function(t,e,i){"use strict";e.exports=function(t,e){for(var i=0,n=t.length;i<n;i++){var s=t[i],r=s.getAttribute("data-item-id");if(("number"==typeof e?parseInt(r,10):r)===e)return s}return null}},{}],40:[function(t,e,i){"use strict";e.exports=function(t,e){return t+"[data-item-id="+('"'+(""+e).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"')+"]"}},{}],41:[function(t,e,i){"use strict";e.exports=function(t){return t.which||t.keyCode||0}},{}],42:[function(t,e,i){"use strict";e.exports=function(t,e){return(t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector).call(t,e)}},{}],43:[function(t,e,i){"use strict";e.exports=function(t){var e=document.createElement("div");return e.innerHTML=t,e.firstChild}},{}],44:[function(t,e,i){"use strict";e.exports=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)}},{}],45:[function(t,e,i){"use strict";e.exports=function(t){t.stopPropagation()}},{}],46:[function(t,e,i){"use strict";e.exports=function(t,e,i){t&&t.classList[i?"add":"remove"](e)}},{}]},{},[36])(36)});